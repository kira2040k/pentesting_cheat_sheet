# SMB enumeration
> smb work on port 139 or 445

----------------------------------

1. **nmap**

```bash
     nmap -v -p 445 --script=smb-enum-shares.nse --script-args=unsafe=1 <IP>  
  
nmap --script=smb-enum-shares.nse,smb-ls.nse,smb-enum-users.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-security-mode.nse,smbv2-enabled.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse,smbv2-enabled.nse <IP> -p 445


# note enum users

     nmap -sU -sS --script=smb-enum-users -p U:137,T:139 <ip>
```

2. ** smb_check.rb**

```bash
./smb_check.rb <IP> <port>
```

3. **enum4linux**
```bash
enum4linux <IP>
```

4. **list-shares**

```bash
#note  Anonymous login allowed

smbmap -H <IP>  
  
smbclient -L <IP>

#note no creds

smbclient //<IP>/<share> -N


# note creds

smbclient //<IP>/<share> -U <username>
```

5. **mount **

```bash
mount -t auto --source //<IP>/share --target /var/tmp/smb/ -o username=<username>,workgroup=WORKGROUP/<wordgroup>
	 
sudo mount -t cifs //<IP>/<export\_share> /mnt/<local\_share>
	 
	 
mount -t nfs <ip>:/site\_backups /root/Desktop/htb/active/remote/data -o nolock
```

6. **smb map**

```bash
smbmap -H <IP> --depth 5  
  
    
smbclient -L <IP> >>> to see the share path's  
smbclient \\\\\\\\<IP>\\\\ov <<< to connect no user or pass  
smbclient \\\\\\\\<IP>\\\\ov -U 'username' it will ask for password  
smbclient //<IP>/ov <<< no user or password  
smbmap -H <IP> >>> enum the host
```
----------------------------------

###### Reference 

1. [what is smb](https://www.varonis.com/blog/smb-port/)
2. [smb_check.rb](https://github.com/jivoi/pentest/blob/master/tools/smb-check-vulns.rb)